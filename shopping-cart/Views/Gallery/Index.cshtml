@using SA51_CA_Project_Team10.Models.DTO
@model GalleryViewModel

@section Scripts
{
    <script src="~/js/gallery.js"></script>
    <script src="~/js/rating.js"></script>
}

@{
    ViewData["Title"] = "Libraries Gallery";
    string searchbarValue = ViewData["Searchbar"]?.ToString() ?? string.Empty;  // Use a default value if null
    int columns = 4;
}
<style>
    .gallery {
        width: 100%;
        border-spacing: 20px; /* Khoảng cách giữa các ô */
        table-layout: fixed; /* Đảm bảo các ô có kích thước cố định */
    }

    .galleryTtd {
        border: 2px solid black;
        padding: 15px;
        box-sizing: border-box; /* Đảm bảo padding và border được tính trong chiều rộng */
        width: 100%; /* Đảm bảo ô chiếm toàn bộ chiều rộng của ô trong bảng */
        text-align: center; /* Căn giữa nội dung trong ô */
    }

    .celldiv {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    td {
        width: 25%; /* Đảm bảo mỗi ô chiếm 25% chiều rộng của hàng */
        vertical-align: top; /* Căn chỉnh nội dung theo phía trên của ô */
    }

    .galleryTtd img {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 80%; /* Điều chỉnh kích thước hình ảnh */
        max-width: 150px; /* Đảm bảo hình ảnh không quá lớn */
        height: auto; /* Duy trì tỷ lệ khung hình */
    }

    .bdiv {
        margin-top: 15px;
        width: 100%; /* Đảm bảo nút bấm chiếm toàn bộ chiều rộng của ô */
        text-align: center;
    }



</style>





<div style="text-align:center">
    <form class="inlinef" action="/Gallery/Index" method="get">
        <input type="number" name="page" value="1" hidden />
        <input style="font-size:30px" size="35" type="text" id="searchbar" name="search" value="@searchbarValue" placeholder="Search.." />
        <button style="font-size:30px; float:right;" type="submit">Go</button>
    </form>
</div>

<table class="gallery" border="0">
    @if (Model?.DisplayedProducts != null && Model.DisplayedProducts.Count > 0)
    {
        @for (int i = 0; i < Model.DisplayedProducts.Count; i += columns)
        {
            <tr>
                @for (int j = i; j < i + columns && j < Model.DisplayedProducts.Count; ++j)
                {
                    var url = string.IsNullOrEmpty(Model.DisplayedProducts[j].ImageUrl) ? "~/images/default.png" : Model.DisplayedProducts[j].ImageUrl;

                    <td class="galleryTtd celldiv">
                        <img src="@url" width="75" height="80" />
                        <h2>@Model.DisplayedProducts[j].Name</h2>
                        <p>@Model.DisplayedProducts[j].Description</p>
                        <button class="productbtn btn btn-outline-dark" type="button" productId="@Model.DisplayedProducts[j].Id">$@Model.DisplayedProducts[j].UnitPrice - Add To Cart</button>
                    </td>
                }
                <!-- Thêm các ô trống nếu số sản phẩm không chia hết cho 4 -->
                @if (Model.DisplayedProducts.Count % columns != 0)
                {
                    @for (int k = 0; k < columns - (Model.DisplayedProducts.Count % columns); k++)
                    {
                        <td class="galleryTtd celldiv"></td>
                    }
                }
            </tr>
        }
    }
</table>


@if (Model?.TotalPage > 1)
{
    <div align="center">
        @if (Model.Page > 1)
        {
            <form class="inlinef" action="/Gallery/Index" method="get">
                <input type="text" name="search" value="@searchbarValue" hidden />
                <button type="submit" name="page" value="@(Model.Page - 1)">&lt&lt</button>
            </form>
        }
        @for (int i = 1; i <= Model.TotalPage; ++i)
        {
            if (i == Model.Page)
            {
                <button class="activePage">@i</button>
            }
            else
            {
                <form class="inlinef" action="/Gallery/Index" method="get">
                    <input type="text" name="search" value="@searchbarValue" hidden />
                    <button type="submit" class="nonactivePage" name="page" value="@i">@i</button>
                </form>
            }
        }
        @if (Model.Page < Model.TotalPage)
        {
            <form class="inlinef" action="/Gallery/Index" method="get">
                <input type="text" name="search" value="@searchbarValue" hidden />
                <button type="submit" name="page" value="@(Model.Page + 1)">&gt&gt</button>
            </form>
        }
    </div>
}
 